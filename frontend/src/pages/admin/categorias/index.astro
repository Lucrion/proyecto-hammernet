---
import AdminLayout from '../../../layouts/AdminLayout.astro';
import categoriasScriptUrl from '../../../scripts/admin/categorias.js?url';
---

<AdminLayout title="Gestión de Categorías">
	<div class="mb-6 flex justify-end items-center">
		<button id="btnNuevaCategoria" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center">
			<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
				<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6" />
			</svg>
			Nueva Categoría
		</button>
	</div>

	<!-- Filtros -->
	<div class="mb-6 grid grid-cols-1 gap-4 sm:grid-cols-2">
		<div>
			<label for="filtroNombre" class="block text-sm font-medium text-gray-700">Buscar por nombre</label>
			<input type="text" id="filtroNombre" placeholder="Nombre de la categoría" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm">
		</div>
		<div class="flex items-end space-x-2">
			<button id="btnBuscar" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg flex items-center">
				<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
					<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
				</svg>
				Buscar
			</button>
		</div>
	</div>

	<!-- Tabla de categorías -->
	<div class="bg-white shadow overflow-hidden sm:rounded-md">
		<div class="overflow-x-auto">
			<table class="min-w-full divide-y divide-gray-200">
				<thead class="bg-gray-50">
					<tr>
						<th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ID</th>
						<th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Nombre</th>
						<th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Descripción</th>
						<th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Acciones</th>
					</tr>
				</thead>
				<tbody id="tablaCategorias" class="bg-white divide-y divide-gray-200">
					<!-- Las categorías se cargarán aquí dinámicamente -->
				</tbody>
			</table>
		</div>
	</div>

	<!-- Paginación -->
	<div id="paginacion" class="mt-6 flex justify-center">
		<!-- La paginación se generará dinámicamente -->
	</div>

		<!-- Modal para nueva/editar categoría -->
		<div id="modalCategoria" class="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full hidden">
			<div class="relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white">
				<div class="mt-3">
					<div class="flex justify-between items-center mb-4">
						<h3 id="tituloModal" class="text-lg font-medium text-gray-900">Nueva Categoría</h3>
						<button id="btnCerrarModal" class="text-gray-400 hover:text-gray-600">
							<i class="fas fa-times"></i>
						</button>
					</div>
					<form id="formCategoria">
						<input type="hidden" id="categoriaId">
						<div class="mb-4">
							<label for="nombre" class="block text-sm font-medium text-gray-700 mb-2">Nombre *</label>
							<input type="text" id="nombre" name="nombre" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
						</div>
						<div class="mb-4">
							<label for="descripcion" class="block text-sm font-medium text-gray-700 mb-2">Descripción</label>
							<textarea id="descripcion" name="descripcion" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"></textarea>
						</div>
						<div class="flex justify-end space-x-2">
							<button type="button" id="btnCancelar" class="bg-gray-500 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded">
								Cancelar
							</button>
							<button type="submit" id="btnGuardar" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">
								Guardar
							</button>
						</div>
					</form>
				</div>
			</div>
		</div>

		<!-- Modal de confirmación para eliminar -->
		<div id="modalConfirmar" class="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full hidden">
			<div class="relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white">
				<div class="mt-3 text-center">
					<div class="mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100">
						<i class="fas fa-exclamation-triangle text-red-600"></i>
					</div>
					<h3 class="text-lg leading-6 font-medium text-gray-900 mt-2">Confirmar eliminación</h3>
					<div class="mt-2 px-7 py-3">
						<p class="text-sm text-gray-500">¿Está seguro que desea eliminar esta categoría? Esta acción no se puede deshacer.</p>
					</div>
					<div class="flex justify-center space-x-2 mt-4">
						<button id="btnCancelarEliminar" class="bg-gray-500 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded">
							Cancelar
						</button>
						<button id="btnConfirmarEliminar" class="bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded">
							Eliminar
						</button>
					</div>
				</div>
			</div>
		</div>
	</main>

	<script type="module" src={categoriasScriptUrl}></script>
</AdminLayout>